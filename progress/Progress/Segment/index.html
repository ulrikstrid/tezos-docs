<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Segment (progress.Progress.Segment)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0-beta2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">progress</a> &#x00BB; <a href="../index.html">Progress</a> &#x00BB; Segment</nav><header class="odoc-preamble"><h1>Module <code><span>Progress.Segment</span></code></h1><p><code>Segment</code> contains a DSL for defining custom progress bars.</p></header><nav class="odoc-toc"><ul><li><a href="#pre-provided-segments">Pre-provided segments</a></li><li><a href="#stateful">Stateful segments</a></li><li><a href="#boxes">Dynamically-sized segments</a></li><li><a href="#combining-segments">Combining segments</a></li></ul></nav><div class="odoc-content"><div class="odoc-include"><div class="spec include"><div class="doc"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type of segments of progress bars that display reported values of type <code>'a</code>.</p></div></div><h3 id="pre-provided-segments"><a href="#pre-provided-segments" class="anchor"></a>Pre-provided segments</h3><div class="odoc-spec"><div class="spec value" id="val-bar" class="anchored"><a href="#val-bar" class="anchor"></a><code><span><span class="keyword">val</span> bar : <span>mode:<span>[ `ASCII <span>| `UTF8</span> ]</span> <span>&#45;&gt;</span></span> <span>?&#8288;width:<span>[ <span>`Fixed of int</span> <span>| `Expand</span> ]</span> <span>&#45;&gt;</span></span>
<span><span>(<span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> float)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bar ~width f</code> is a progress bar of the form:</p><pre><code>[#######################################................] </code></pre><p>which occupies <code>width</code>-many columns and uses <code>f</code> to determine the proportion of the bar that is filled.</p><p>If <code>~width:`Expand</code> is passed – which is the default – this segment must be contained inside a <a href="../index.html#boxes">box</a> that determines its size.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-const" class="anchored"><a href="#val-const" class="anchor"></a><code><span><span class="keyword">val</span> const : <span>string <span>&#45;&gt;</span></span> <span><span class="type-var">_</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>const s</code> is the segment that always displays <code>s</code>. <code>s</code> must not contain any newline characters.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-const_fmt" class="anchored"><a href="#val-const_fmt" class="anchor"></a><code><span><span class="keyword">val</span> const_fmt : <span>width:int <span>&#45;&gt;</span></span> <span><span>(<span><a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span></span> unit)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">_</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><a href="#val-const_fmt"><code>const_fmt</code></a> is a variant of <a href="#val-const"><code>const</code></a> that takes a fixed-width pretty-printer rather than a string.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_pp" class="anchored"><a href="#val-of_pp" class="anchor"></a><code><span><span class="keyword">val</span> of_pp : <span>width:int <span>&#45;&gt;</span></span> <span><span>(<span><a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> unit)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_pp ~width pp</code> is a segment that uses the supplied fixed-width pretty-printer to render the value. The pretty-printer must never emit newline characters.</p></div></div><h3 id="stateful"><a href="#stateful" class="anchor"></a>Stateful segments</h3><div class="odoc-spec"><div class="spec value" id="val-periodic" class="anchored"><a href="#val-periodic" class="anchor"></a><code><span><span class="keyword">val</span> periodic : <span>int <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>periodic n s</code> has the same output format as <code>s</code>, but only passes reported values down to <code>s</code> on every <code>n</code>-th call. This is useful when progress is being reported from a hot-loop, where the cost of rendering is non-negligible.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-accumulator" class="anchored"><a href="#val-accumulator" class="anchor"></a><code><span><span class="keyword">val</span> accumulator : <span><span>(<span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>accumulator combine zero s</code> has the same output format <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-stateful" class="anchored"><a href="#val-stateful" class="anchor"></a><code><span><span class="keyword">val</span> stateful : <span><span>(<span>unit <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>stateful f</code> is a segment that behaves as <code>f ()</code> for any given render, allowing <code>f</code> to initialise any display state at the start of the rendering process.</p></div></div><h3 id="boxes"><a href="#boxes" class="anchor"></a>Dynamically-sized segments</h3><p>Certain segments can have their size determined dynamically by being wrapped inside one of the following boxes:</p><div class="odoc-spec"><div class="spec value" id="val-box_dynamic" class="anchored"><a href="#val-box_dynamic" class="anchor"></a><code><span><span class="keyword">val</span> box_dynamic : <span><span>(<span>unit <span>&#45;&gt;</span></span> int)</span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>box w</code> is a box that wraps a dynamically-sized segment and sets it to have size <code>w ()</code> on each tick.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-box_winsize" class="anchored"><a href="#val-box_winsize" class="anchor"></a><code><span><span class="keyword">val</span> box_winsize : <span>fallback:int <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>A box that takes on the current size of the terminal (or <code>fallback</code> if stdout is not attached to a terminal.)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-box_fixed" class="anchored"><a href="#val-box_fixed" class="anchor"></a><code><span><span class="keyword">val</span> box_fixed : <span>int <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>box-fixed n s</code> fixes the size of the dynamic segment <code>s</code> to be <code>n</code>.</p></div></div><h3 id="combining-segments"><a href="#combining-segments" class="anchor"></a>Combining segments</h3><div class="odoc-spec"><div class="spec value" id="val-(++)" class="anchored"><a href="#val-(++)" class="anchor"></a><code><span><span class="keyword">val</span> (++) : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Horizontally join two segments of the same reported value type.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-list" class="anchored"><a href="#val-list" class="anchor"></a><code><span><span class="keyword">val</span> list : <span>?&#8288;sep:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> list</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Horizontally join a list of segments, with a given separator. <code>sep</code> defaults to <code>const &quot; &quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pair" class="anchored"><a href="#val-pair" class="anchor"></a><code><span><span class="keyword">val</span> pair : <span>?&#8288;sep:<span>unit <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Horizontally join a pair of segments consuming different reported values into a single segment that consumes a pair.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-using" class="anchored"><a href="#val-using" class="anchor"></a><code><span><span class="keyword">val</span> using : <span><span>(<span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>using f s</code> is a segment that first applies <code>f</code> to the reported value and then behaves as segment <code>s</code>.</p></div></div></div></div></div></div></body></html>