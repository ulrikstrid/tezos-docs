<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tezos_p2p__P2p_maintenance (tezos-p2p.Tezos_p2p__P2p_maintenance)</title><link rel="stylesheet" href="../../odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0-beta2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">tezos-p2p</a> &#x00BB; Tezos_p2p__P2p_maintenance</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_p2p__P2p_maintenance</span></code></h1><p>P2P maintenance worker.</p><p>This worker enforces the connection bounds defined on the command-line or/and the configuration file.</p><p>The maintenance process is launched: . When any of the following future is resolved <code>P2p_trigger.wait_too_few_connections</code> <code>P2p_trigger.wait_too_many_connections</code> . When <code>maintain</code> is called . After <code>maintenance_idle_time</code> if none of the other conditions have been met.</p><p>If the number of connections is above the limit, the maintainer kills existing connections.</p><p>If below the limit, it tries to connect to points available from <code>P2p_pool</code>. If not enough connections can be obtained, it requests new points from <code>P2p_pool</code> using <code>P2p_pool.broadcast msg</code>, and wakes up the <code>P2p_discovery</code> worker. It then waits for new peers or points by waiting on futures <code>P2p_trigger.wait_new_peer</code> <code>P2p_trigger.wait_new_point</code> This is reiterated indefinitely every <code>require_new_points_time</code>.</p></header><div class="odoc-content"></div></body></html>