<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>WeakRingTable (tezos-protocol-environment-structs.Tezos_protocol_environment_structs.V2.M.Operation_list_list_hash.WeakRingTable)</title><link rel="stylesheet" href="../../../../../../odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0-beta2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">tezos-protocol-environment-structs</a> &#x00BB; <a href="../../../../index.html">Tezos_protocol_environment_structs</a> &#x00BB; <a href="../../../index.html">V2</a> &#x00BB; <a href="../../index.html">M</a> &#x00BB; <a href="../index.html">Operation_list_list_hash</a> &#x00BB; WeakRingTable</nav><header class="odoc-preamble"><h1>Module <code><span>Operation_list_list_hash.WeakRingTable</span></code></h1></header><div class="odoc-content"><div class="odoc-include"><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span><span class="keyword">include</span> <a href="../../../../../../ringo/Ringo/module-type-CACHE_MAP/index.html">Ringo.CACHE_MAP</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../../../ringo/Ringo/module-type-CACHE_MAP/index.html#type-key">key</a> = <a href="../index.html#type-t">t</a></span></span></code></span></summary><div class="odoc-spec"><div class="spec type" id="type-key" class="anchored"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> key</span><span> = <a href="../index.html#type-t">t</a></span></code></div><div class="spec-doc"><p>The type of keys on which values in the cache are indexed.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type of caches holding bindings from <code>key</code> to <code>'a</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>int <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>create n</code> creates a cache with a size-bound of <code>n</code>. Remember that the size-bound is not upheld strictly by all caches.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-replace" class="anchored"><a href="#val-replace" class="anchor"></a><code><span><span class="keyword">val</span> replace : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>replace c k v</code> binds the key <code>k</code> to the value <code>v</code> in the cache <code>c</code>. This may or may not cause another binding to be removed from the cache, depending on the number of bindings already present in the cache <code>c</code>, the size-bound of the cache <code>c</code>, and the policy of the cache <code>c</code> towards its size-bound.</p><p>If <code>k</code> is already bound to a value in <code>c</code>, the previous binding disappears and is replaced by the new binding to <code>v</code>.</p><p>Note that in caches with a <code>Sloppy</code> accounting policy, the old binding is erased but may still count towards the size bound for some time. In other words: apart for size bound consideration, the following sequences of operations are indistinguishable: <code>replace c k v; replace c k u</code> <code>replace c k v; remove c k; replace c k u</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold" class="anchored"><a href="#val-fold" class="anchor"></a><code><span><span class="keyword">val</span> fold : <span><span>(<span><a href="#type-key">key</a> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span>&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span>&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>fold f c init</code> folds the function <code>f</code> and value <code>init</code> over the bindings of <code>c</code>.</p><p>Note that for caches with a <code>Weak</code> overflow policy, this function may fold over a subset of the bindings of <code>c</code>. See <code>Ringo</code> (or <code>Functors</code>) for more details.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_v" class="anchored"><a href="#val-fold_v" class="anchor"></a><code><span><span class="keyword">val</span> fold_v : <span><span>(<span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span>&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span>&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>fold_v f c init</code> folds the function <code>f</code> and value <code>init</code> over the values held by the bindings of <code>c</code>.</p><p>It is less powerful than <code>fold</code> in that it does not grant access to the bindings' keys, but it does fold over all the values bound in <code>c</code>, even when the <code>c</code> has a <code>Weak</code> overflow policy.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_opt" class="anchored"><a href="#val-find_opt" class="anchor"></a><code><span><span class="keyword">val</span> find_opt : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>find_opt c k</code> is <code>Some v</code> if <code>k</code> is bound to <code>v</code> in <code>c</code>. It is <code>None</code> otherwise.</p><p>Note that the in caches with a non-<code>FIFO</code> replacement policy, this may have a side effect on the <code>k</code>-to-<code>v</code> binding. Specifically, in those caches, it might make it less likely to be removed when supernumerary bindings are inserted.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-remove" class="anchored"><a href="#val-remove" class="anchor"></a><code><span><span class="keyword">val</span> remove : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span>&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>remove c k</code> removes the binding from <code>k</code> in <code>c</code>. If <code>k</code> is not bound in <code>c</code>, it does nothing.</p><p>Note that in caches with a <code>Sloppy</code> accounting policy, removed bindings can still count towards the size bound for some time.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-length" class="anchored"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>length c</code> is the number of bindings held by <code>c</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-capacity" class="anchored"><a href="#val-capacity" class="anchor"></a><code><span><span class="keyword">val</span> capacity : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>capacity c</code> is the number of bindings <code>c</code> can hold: <code>capacity (create n) = n</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-clear" class="anchored"><a href="#val-clear" class="anchor"></a><code><span><span class="keyword">val</span> clear : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span>&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>clear c</code> removes all bindings from <code>c</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-H" class="anchored"><a href="#module-H" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="H/index.html">H</a></span><span> : <a href="../../../../../../ocaml/Stdlib/Hashtbl/module-type-HashedType/index.html">Stdlib.Hashtbl.HashedType</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../../../ocaml/Stdlib/Hashtbl/module-type-HashedType/index.html#type-t">t</a> = <a href="#type-key">key</a></span></span></code></div></div></details></div></div></div><div class="odoc-spec"><div class="spec value" id="val-encoding" class="anchored"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><span><span class="type-var">'a</span> <a href="../../../../../../data-encoding/Data_encoding/index.html#type-t">Data_encoding.t</a></span> <span>&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="../../../../../../data-encoding/Data_encoding/index.html#type-t">Data_encoding.t</a></span></span></code></div></div></div></body></html>