<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>interface (odoc.interface)</title><link rel="stylesheet" href="../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0-beta2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="index.html">Up</a> â€“ <a href="index.html">odoc</a> &#x00BB; interface</nav><header class="odoc-preamble"><h1 id="odoc-interface-guarantees"><a href="#odoc-interface-guarantees" class="anchor"></a>Odoc interface guarantees</h1><p>Odoc has several 'public facing' parts, with varying levels of support guarantees. This document describes what those interfaces are and what the support levels are now and what we aim for in the future.</p></header><nav class="odoc-toc"><ul><li><a href="#documentation-comments">Documentation comments</a><ul><li><a href="#changes">Changes</a><ul><li><a href="#omissions">Omissions</a></li><li><a href="#improvements">Improvements</a></li></ul></li><li><a href="#reference-syntax">Reference syntax</a></li></ul></li><li><a href="#cli-interface">CLI interface</a></li><li><a href="#output-formats">Output formats</a></li><li><a href="#libraries">Libraries</a></li><li><a href="#intermediate-files">Intermediate files</a></li></ul></nav><div class="odoc-content"><h3 id="documentation-comments"><a href="#documentation-comments" class="anchor"></a>Documentation comments</h3><p>The first and most important is the syntax of the documentation comments present in source code. This is relevant to everyone who is writing code intended to be documented by odoc, and hence is applies to the widest set of people.</p><p>The canonical description of the markup that odoc understands is in <a href="https://caml.inria.fr/pub/docs/manual-ocaml/ocamldoc.html#s%3Aocamldoc-comments">this section</a> of the OCaml reference manual. The eventual aim is to support the in-code markup in its entirety, although right now there are some gaps. There are also some extensions where odoc goes beyond what is officially supported.</p><h4 id="changes"><a href="#changes" class="anchor"></a>Changes</h4><p>The following describes the changes between what odoc understands and what is in the OCaml manual.</p><h5 id="omissions"><a href="#omissions" class="anchor"></a>Omissions</h5><ul><li>Comments describing class inheritance are not rendered (<a href="https://github.com/ocaml/odoc/issues/574">github issue</a>).</li><li>Odoc handles ambiguous documentation comments as the compiler does (see <a href="https://caml.inria.fr/pub/docs/manual-ocaml/doccomments.html">here</a>) rather than treating them as the ocamldoc manual suggests.</li><li>Odoc does not ignore tags where they don't make sense (e.g. <code>@param</code> tags on instance variables are rendered) (<a href="https://github.com/ocaml/odoc/issues/575">github issue</a>)</li><li><a href="https://caml.inria.fr/pub/docs/manual-ocaml/ocamldoc.html#ss:ocamldoc-formatting">Alignment elements</a> are not handled (<code>{C text}</code>, <code>{L text}</code> and <code>{R text}</code>) (<a href="https://github.com/ocaml/odoc/issues/541">github issue</a>)</li><li>Odoc does not recognise <a href="https://caml.inria.fr/pub/docs/manual-ocaml/ocamldoc.html#sss:ocamldoc-html-tags">html tags embedded in comments</a> (<a href="https://github.com/ocaml/odoc/issues/576">github issue</a>)</li><li><code>{!indexlist}</code> is not supported (<a href="https://github.com/ocaml/odoc/issues/577">github issue</a>)</li><li>When rendering <code>{!modules:...}</code> lists, the first paragraph is used instead of the <a href="https://caml.inria.fr/pub/docs/manual-ocaml/ocamldoc.html#sss:ocamldoc-preamble">first sentence</a>.</li></ul><h5 id="improvements"><a href="#improvements" class="anchor"></a>Improvements</h5><ul><li>Odoc has a better mechanism for disambiguating references in comments. See 'reference syntax' later in this document.</li><li>Built-in support for standalone 'mld' files - these are documents using the OCamldoc markup, but rendered as distinct pages.</li><li>Structured output - odoc can produce output in a structured directory tree rather a set of files.</li><li>A few extra tags are supported:</li></ul><ol><li><code>@returns</code> is a synonym for <code>@return</code></li><li><code>@raises</code> is a synonym for <code>@raise</code></li><li><code>@open</code> and <code>@closed</code> and <code>@inline</code> are hints for how 'included' signatures should be rendered</li><li><code>@canonical</code> allows a definition of a module to be marked as canonically elsewhere.</li></ol><h4 id="reference-syntax"><a href="#reference-syntax" class="anchor"></a>Reference syntax</h4><p>Odoc has a far more powerful reference resolution mechanism than ocamldoc. While it supports the mechanism in ocamldoc used for disambiguating between different types of references, it offers a more powerful alternative. The new mechanism allows for disambiguation of each part in a dotted reference rather than just the final part. For example, where in the reference manual it suggests the syntax <code>{!type:Foo.Bar.t}</code> to designate a type, and <code>{!val:Foo.Bar.t}</code> a value of the same name, the new Odoc syntax for these comments would be <code>{!Foo.Bar.type-t}</code> and <code>{!Foo.Bar.val-t}</code>. This allows odoc to disambiguate when there are other ambiguous elements within the path. For example, we can distinguish between a type or value t within a module or module type with the same name: <code>{!module-Foo.module-type-Bar.type-t}</code> or <code>{!module-type-Foo.module-Bar.val-t}</code>.</p><p>Additionally we support extra annotations:</p><ul><li><code>module-type</code> is a replacement for <code>modtype</code></li><li><code>class-type</code> is a replacement for <code>classtype</code></li><li><code>exn</code> is recognised as <code>exception</code></li><li><code>extension</code> refers to a type extension</li><li><code>field</code> is a replacement for <code>recfield</code></li><li><code>instance-variable</code> refers to instance variables</li><li><code>label</code> refers to labels introduced in anchors</li><li><code>page</code> refers to <code>mld</code> pages as outlined above</li><li><code>value</code> is recognised as <code>val</code></li></ul><p>This will be described more completely in a separate document.</p><h3 id="cli-interface"><a href="#cli-interface" class="anchor"></a>CLI interface</h3><p>The way in which the odoc CLI is invoked is not trivial, and requires careful ordering and correct arguments to produce correctly linked documentation. It is not expected that end-users will invoke odoc by hand, but rather it will be driven by a separate tool. As a consequence of this it is important that we preserve the ability of these tools to create good documentation with each release of odoc, and thus we will ensure backward compatibility of the CLI as much as possible. There are currently 3 tools that 'drive' odoc that are considered 'first class' in that we will not make releases of odoc whilst knowingly breaking these tools. These are:</p><ul><li>Odig</li><li>Dune</li><li>OCaml</li></ul><p>OCaml here refers to the newly merged configure option (from 4.12.0) to build the standard library documentation with odoc. If the recommended way of invoking odoc changes we will work with the maintainers of these projects to ensure they are updated correspondingly.</p><p>Additionally there will be a reference implementation of a tool to build Odoc's documentation which should serve as a guide for anyone building other 'drivers' of odoc.</p><h3 id="output-formats"><a href="#output-formats" class="anchor"></a>Output formats</h3><p>Odoc currently outputs HTML files, man pages and latex documents. In a similar vein to the CLI interface, we will try to ensure that the three tools described above will will not be broken by any changes to the outputs - that is, that they will succeed and produce documentation that is 'correct'. We do not make any guarantees about the internal structure of the output documents - for example, the exact nesting of tags or sequence of latex commands may not be preserved. We will attempt to ensure that the anchors in the HTML are preserved though, implying also that the filenames will also be preserved.</p><h3 id="libraries"><a href="#libraries" class="anchor"></a>Libraries</h3><p>Odoc has several internal libraries. The only one of these for which we currently expect external users is the comment parser. This will soon be removed into an external package to link with separately and will have its own lifecycle and support statement. Note that this will replace the existing <code>octavius</code> library, which was the original implementation of odoc's current parser.</p><h3 id="intermediate-files"><a href="#intermediate-files" class="anchor"></a>Intermediate files</h3><p>The intermediate files that odoc produces - <code>.odoc</code> and <code>.odocl</code> should be considered to be internal only and tied to the specific version of odoc.</p></div></body></html>