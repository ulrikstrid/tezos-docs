<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Json_repr (json-data-encoding.Json_repr)</title><link rel="stylesheet" href="../../odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0-beta2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">json-data-encoding</a> &#x00BB; Json_repr</nav><header class="odoc-preamble"><h1>Module <code><span>Json_repr</span></code></h1><p>Representations of JSON documents</p></header><nav class="odoc-toc"><ul><li><a href="#abstraction-over-json-representations">Abstraction over JSON representations</a></li><li><a href="#third-party-in-memory-json-document-representations">Third party in-memory JSON document representations</a></li><li><a href="#representation-agnostic-json-format">Representation-agnostic JSON format</a></li><li><a href="#predefined-converters-for-ezjsonm">Predefined converters for ezjsonm</a></li></ul></nav><div class="odoc-content"><h3 id="abstraction-over-json-representations"><a href="#abstraction-over-json-representations" class="anchor"></a>Abstraction over JSON representations</h3><div class="odoc-spec"><div class="spec type" id="type-view" class="anchored"><a href="#type-view" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a view</span></span><span> = </span><span>[ </span></code><table><tr id="type-view.O" class="anchored"><td class="def constructor"><a href="#type-view.O" class="anchor"></a><code><span>| </span></code><code><span>`O <span class="keyword">of</span> <span><span>(string * <span class="type-var">'a</span>)</span> list</span></span></code></td><td class="doc"><p>An associative table (object).</p></td></tr><tr id="type-view.A" class="anchored"><td class="def constructor"><a href="#type-view.A" class="anchor"></a><code><span>| </span></code><code><span>`A <span class="keyword">of</span> <span><span class="type-var">'a</span> list</span></span></code></td><td class="doc"><p>An (integer indexed) array.</p></td></tr><tr id="type-view.Bool" class="anchored"><td class="def constructor"><a href="#type-view.Bool" class="anchor"></a><code><span>| </span></code><code><span>`Bool <span class="keyword">of</span> bool</span></code></td><td class="doc"><p>A JS boolean <code>true</code> or <code>false</code>.</p></td></tr><tr id="type-view.Float" class="anchored"><td class="def constructor"><a href="#type-view.Float" class="anchor"></a><code><span>| </span></code><code><span>`Float <span class="keyword">of</span> float</span></code></td><td class="doc"><p>A floating point number (double precision).</p></td></tr><tr id="type-view.String" class="anchored"><td class="def constructor"><a href="#type-view.String" class="anchor"></a><code><span>| </span></code><code><span>`String <span class="keyword">of</span> string</span></code></td><td class="doc"><p>An UTF-8 encoded string.</p></td></tr><tr id="type-view.Null" class="anchored"><td class="def constructor"><a href="#type-view.Null" class="anchor"></a><code><span>| </span></code><code><span>`Null</span></code></td><td class="doc"><p>The <code>null</code> constant.</p></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The internal format used by the library. A common format to view JSON structures from different representations. It only shows the head of structures, hiding the contents of fields, so that the conversion from another format or a stream can be done lazily.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-repr_uid" class="anchored"><a href="#type-repr_uid" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a repr_uid</span></span></code></div><div class="spec-doc"><p>Each representation must provide a unique identifier, obtained via the <a href="#val-repr_uid"><code>repr_uid</code></a> function. This identifier is used when converting between representations, to optimize out a copy when converting from a representation to itself. Beware that this optimization relies only on this <code>uid</code> token. Converting between values of the same type using two different representation modules with different <code>uid</code>s will perform a copy. A practical way to ensure that the optimization is made is to write your representations as toplevel modules, and not inside functors.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-repr_uid" class="anchored"><a href="#val-repr_uid" class="anchor"></a><code><span><span class="keyword">val</span> repr_uid : <span>unit <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-repr_uid">repr_uid</a></span></span></code></div><div class="spec-doc"><p>See <a href="#type-repr_uid"><code>repr_uid</code></a>.</p></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Repr" class="anchored"><a href="#module-type-Repr" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-Repr/index.html">Repr</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A view over a given implementation.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-convert" class="anchored"><a href="#val-convert" class="anchor"></a><code><span><span class="keyword">val</span> convert : <span><span>(<span class="keyword">module</span> <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <span class="type-var">'tf</span>)</span> <span>&#45;&gt;</span></span> <span><span>(<span class="keyword">module</span> <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <span class="type-var">'tt</span>)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'tf</span> <span>&#45;&gt;</span></span> <span class="type-var">'tt</span></span></code></div><div class="spec-doc"><p>Convert a JSON value from one representation to another.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span>?&#8288;compact:bool <span>&#45;&gt;</span></span> <span>?&#8288;pp_string:<span>(<span><a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span></span> <span>string <span>&#45;&gt;</span></span> unit)</span> <span>&#45;&gt;</span></span>
<span><span>(<span class="keyword">module</span> <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <span class="type-var">'tf</span>)</span> <span>&#45;&gt;</span></span> <span><a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span></span> <span><span class="type-var">'tf</span> <span>&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Generic pretty-printer. If <code>compact</code> is set (by default), then the output is not really pretty (no space is output). Ascii-compatible string encoding is expected, as printing only escapes double quotes and control characters. Use <code>pp_string</code> for more advanced escaping. This function does not claim to be the best JSON pretty printer, it is mostly a small utility.</p></div></div><h3 id="third-party-in-memory-json-document-representations"><a href="#third-party-in-memory-json-document-representations" class="anchor"></a>Third party in-memory JSON document representations</h3><div class="odoc-spec"><div class="spec type" id="type-ezjsonm" class="anchored"><a href="#type-ezjsonm" class="anchor"></a><code><span><span class="keyword">type</span> ezjsonm</span><span> = </span><span>[ </span></code><table><tr id="type-ezjsonm.O" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.O" class="anchor"></a><code><span>| </span></code><code><span>`O <span class="keyword">of</span> <span><span>(string * <a href="#type-ezjsonm">ezjsonm</a>)</span> list</span></span></code></td><td class="doc"><p>An associative table (object).</p></td></tr><tr id="type-ezjsonm.A" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.A" class="anchor"></a><code><span>| </span></code><code><span>`A <span class="keyword">of</span> <span><a href="#type-ezjsonm">ezjsonm</a> list</span></span></code></td><td class="doc"><p>An (integer indexed) array.</p></td></tr><tr id="type-ezjsonm.Bool" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.Bool" class="anchor"></a><code><span>| </span></code><code><span>`Bool <span class="keyword">of</span> bool</span></code></td><td class="doc"><p>A JS boolean <code>true</code> or <code>false</code>.</p></td></tr><tr id="type-ezjsonm.Float" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.Float" class="anchor"></a><code><span>| </span></code><code><span>`Float <span class="keyword">of</span> float</span></code></td><td class="doc"><p>A floating point number (double precision).</p></td></tr><tr id="type-ezjsonm.String" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.String" class="anchor"></a><code><span>| </span></code><code><span>`String <span class="keyword">of</span> string</span></code></td><td class="doc"><p>An UTF-8 encoded string.</p></td></tr><tr id="type-ezjsonm.Null" class="anchored"><td class="def constructor"><a href="#type-ezjsonm.Null" class="anchor"></a><code><span>| </span></code><code><span>`Null</span></code></td><td class="doc"><p>The <code>null</code> constant.</p></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>A JSON value compatible with <a href="Ezjsonm/index.html#type-value"><code>Ezjsonm.value</code></a>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Ezjsonm" class="anchored"><a href="#module-Ezjsonm" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Ezjsonm/index.html">Ezjsonm</a></span><span> : <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <a href="#type-ezjsonm">ezjsonm</a></span></span></code></div><div class="spec-doc"><p>A view over the <a href="#type-ezjsonm"><code>ezjsonm</code></a> representation.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-yojson" class="anchored"><a href="#type-yojson" class="anchor"></a><code><span><span class="keyword">type</span> yojson</span><span> = </span><span>[ </span></code><table><tr id="type-yojson.Bool" class="anchored"><td class="def constructor"><a href="#type-yojson.Bool" class="anchor"></a><code><span>| </span></code><code><span>`Bool <span class="keyword">of</span> bool</span></code></td><td class="doc"><p>A JS boolean <code>true</code> of <code>false</code>.</p></td></tr><tr id="type-yojson.Assoc" class="anchored"><td class="def constructor"><a href="#type-yojson.Assoc" class="anchor"></a><code><span>| </span></code><code><span>`Assoc <span class="keyword">of</span> <span><span>(string * <a href="#type-yojson">yojson</a>)</span> list</span></span></code></td><td class="doc"><p>JSON object.</p></td></tr><tr id="type-yojson.Float" class="anchored"><td class="def constructor"><a href="#type-yojson.Float" class="anchor"></a><code><span>| </span></code><code><span>`Float <span class="keyword">of</span> float</span></code></td><td class="doc"><p>A floating point number (double precision).</p></td></tr><tr id="type-yojson.Int" class="anchored"><td class="def constructor"><a href="#type-yojson.Int" class="anchor"></a><code><span>| </span></code><code><span>`Int <span class="keyword">of</span> int</span></code></td><td class="doc"><p>A number without decimal point or exponent.</p></td></tr><tr id="type-yojson.Intlit" class="anchored"><td class="def constructor"><a href="#type-yojson.Intlit" class="anchor"></a><code><span>| </span></code><code><span>`Intlit <span class="keyword">of</span> string</span></code></td><td class="doc"><p>A number without decimal point or exponent, preserved as string.</p></td></tr><tr id="type-yojson.List" class="anchored"><td class="def constructor"><a href="#type-yojson.List" class="anchor"></a><code><span>| </span></code><code><span>`List <span class="keyword">of</span> <span><a href="#type-yojson">yojson</a> list</span></span></code></td><td class="doc"><p>A JS array.</p></td></tr><tr id="type-yojson.Null" class="anchored"><td class="def constructor"><a href="#type-yojson.Null" class="anchor"></a><code><span>| </span></code><code><span>`Null</span></code></td><td class="doc"><p>The <code>null</code> constant.</p></td></tr><tr id="type-yojson.String" class="anchored"><td class="def constructor"><a href="#type-yojson.String" class="anchor"></a><code><span>| </span></code><code><span>`String <span class="keyword">of</span> string</span></code></td><td class="doc"><p>An UTF-8 encoded string.</p></td></tr><tr id="type-yojson.Tuple" class="anchored"><td class="def constructor"><a href="#type-yojson.Tuple" class="anchor"></a><code><span>| </span></code><code><span>`Tuple <span class="keyword">of</span> <span><a href="#type-yojson">yojson</a> list</span></span></code></td><td class="doc"><p>A tuple (non-standard). Syntax: (&quot;abc&quot;, 123).</p></td></tr><tr id="type-yojson.Variant" class="anchored"><td class="def constructor"><a href="#type-yojson.Variant" class="anchor"></a><code><span>| </span></code><code><span>`Variant <span class="keyword">of</span> string * <span><a href="#type-yojson">yojson</a> option</span></span></code></td><td class="doc"><p>A variant (non-standard). Syntax: &lt;&quot;Foo&quot;&gt; or &lt;&quot;Bar&quot;: 123&gt;.</p></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>A JSON value compatible with <code>Yojson</code>.Safe.json.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Yojson" class="anchored"><a href="#module-Yojson" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Yojson/index.html">Yojson</a></span><span> : <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <a href="#type-yojson">yojson</a></span></span></code></div><div class="spec-doc"><p>A view over the <a href="#type-yojson"><code>yojson</code></a> representation.</p></div></div><h3 id="representation-agnostic-json-format"><a href="#representation-agnostic-json-format" class="anchor"></a>Representation-agnostic JSON format</h3><div class="odoc-spec"><div class="spec type" id="type-any" class="anchored"><a href="#type-any" class="anchor"></a><code><span><span class="keyword">type</span> any</span><span> = <span class="keyword">private</span> </span></code><table><tr id="type-any.Value_with_repr" class="anchored"><td class="def variant constructor"><a href="#type-any.Value_with_repr" class="anchor"></a><code><span>| </span><span><span class="constructor">Value_with_repr</span> : <span>(<span class="keyword">module</span> <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <span class="type-var">'a</span>)</span> * <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="#type-any">any</a></span></code></td></tr></table></div><div class="spec-doc"><p>A meta-representation for JSON values that can unify values of different representations by boxing them with their corresponding <a href="module-type-Repr/index.html"><code>Repr</code></a> modules.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-any_to_repr" class="anchored"><a href="#val-any_to_repr" class="anchor"></a><code><span><span class="keyword">val</span> any_to_repr : <span><span>(<span class="keyword">module</span> <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span></span> <span><a href="#type-any">any</a> <span>&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Converts a boxed value from its intrinsic representation to the one of the given <a href="module-type-Repr/index.html"><code>Repr</code></a> module. Optimized if the internal representation of the value actually is the requested one.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-repr_to_any" class="anchored"><a href="#val-repr_to_any" class="anchor"></a><code><span><span class="keyword">val</span> repr_to_any : <span><span>(<span class="keyword">module</span> <a href="module-type-Repr/index.html">Repr</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Repr/index.html#type-value">value</a> = <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span>&#45;&gt;</span></span> <a href="#type-any">any</a></span></code></div><div class="spec-doc"><p>Boxes a value with a compatible <a href="module-type-Repr/index.html"><code>Repr</code></a> module.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_any" class="anchored"><a href="#val-pp_any" class="anchor"></a><code><span><span class="keyword">val</span> pp_any : <span>?&#8288;compact:bool <span>&#45;&gt;</span></span> <span>?&#8288;pp_string:<span>(<span><a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span></span> <span>string <span>&#45;&gt;</span></span> unit)</span> <span>&#45;&gt;</span></span> <span>unit <span>&#45;&gt;</span></span> <span><a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span></span> <span><a href="#type-any">any</a> <span>&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Pretty-printer for values of type <a href="#type-any"><code>any</code></a>. See <a href="#val-pp"><code>pp</code></a> for details.</p></div></div><h3 id="predefined-converters-for-ezjsonm"><a href="#predefined-converters-for-ezjsonm" class="anchor"></a>Predefined converters for ezjsonm</h3><p>see <a href="#type-ezjsonm"><code>ezjsonm</code></a></p><div class="odoc-spec"><div class="spec value" id="val-from_yojson" class="anchored"><a href="#val-from_yojson" class="anchor"></a><code><span><span class="keyword">val</span> from_yojson : <span><span>[&lt; <a href="#type-yojson">yojson</a> ]</span> <span>&#45;&gt;</span></span> <span>[&gt; <a href="#type-ezjsonm">ezjsonm</a> ]</span></span></code></div><div class="spec-doc"><p>Conversion helper.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_yojson" class="anchored"><a href="#val-to_yojson" class="anchor"></a><code><span><span class="keyword">val</span> to_yojson : <span><span>[&lt; <a href="#type-ezjsonm">ezjsonm</a> ]</span> <span>&#45;&gt;</span></span> <span>[&gt; <a href="#type-yojson">yojson</a> ]</span></span></code></div><div class="spec-doc"><p>Conversion helper.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-from_any" class="anchored"><a href="#val-from_any" class="anchor"></a><code><span><span class="keyword">val</span> from_any : <span><a href="#type-any">any</a> <span>&#45;&gt;</span></span> <span>[&gt; <a href="#type-ezjsonm">ezjsonm</a> ]</span></span></code></div><div class="spec-doc"><p>Converts a boxed value from its representation to <a href="#type-ezjsonm"><code>ezjsonm</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_any" class="anchored"><a href="#val-to_any" class="anchor"></a><code><span><span class="keyword">val</span> to_any : <span><span>[&lt; <a href="#type-ezjsonm">ezjsonm</a> ]</span> <span>&#45;&gt;</span></span> <a href="#type-any">any</a></span></code></div><div class="spec-doc"><p>Boxes as <a href="#type-ezjsonm"><code>ezjsonm</code></a> value.</p></div></div></div></body></html>